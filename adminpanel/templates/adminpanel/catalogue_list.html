<!doctype html>
<html>
<head><title>Catalogue</title></head>
<body>
<h1>Product Catalogue</h1>

<!-- ...existing code... -->
<form method="get">
  <input type="text" name="q" placeholder="Search SKU or name" value="{{ q }}">
  <select name="category">
    <option value="">All categories</option>
    {% for c in categories %}
      <option value="{{ c.category_id }}" {% if category_id == c.category_id|stringformat:"s" %}selected{% endif %}>{{ c.category_name }}</option>
    {% endfor %}
  </select>
  <label>
    <input type="checkbox" name="show_hidden" value="1" {% if show_hidden %}checked{% endif %}> Show hidden
  </label>
  <button type="submit">Apply</button>
  <a href="{% url 'adminpanel:product_create' %}">Add product</a>
</form>

<h3>Create Category</h3>
<form method="post" action="{% url 'adminpanel:category_create' %}">{% csrf_token %}
  {{ category_form.category_name }}
  <button type="submit">Add Category</button>
</form>

<h3>Create Subcategory</h3>
<form method="post" action="{% url 'adminpanel:subcategory_create' %}">{% csrf_token %}
  {{ subcategory_form.subcategory_name }} {{ subcategory_form.category }}
  <button type="submit">Add Subcategory</button>
</form>

<table border="1" cellpadding="6">
  <tr>
    <th>SKU</th><th>Name</th><th>Category/Subcategory</th><th>Qty</th><th>Unit Price</th><th>Hidden?</th><th>Actions</th>
  </tr>
  {% for p in products %}
  <tr>
    <td>{{ p.sku }}</td>
    <td>{{ p.product_name }}</td>
    <td>
      {% if p.product_subcategory %}
        {{ p.product_subcategory.subcategory_name }} ({{ p.product_subcategory.category.category_name }})
      {% else %}
        â€”
      {% endif %}
    </td>
    <td>{{ p.quantity_on_hand }}</td>
    <td>{{ p.unit_price }}</td>
    <td>{% if p.hidden_flag %}Yes{% else %}No{% endif %}</td>
    <td>
      <a href="{% url 'adminpanel:product_edit' p.sku %}">Edit</a> |
      <a href="{% url 'adminpanel:product_delete' p.sku %}">Delete</a> |
      <a href="{% url 'adminpanel:product_toggle_hidden' p.sku %}">{% if p.hidden_flag %}Unhide{% else %}Hide{% endif %}</a>
    </td>
  </tr>
  {% empty %}
  <tr><td colspan="7">No products.</td></tr>
  {% endfor %}
</table>

<div>
  {% if products.has_previous %}<a href="?page={{ products.previous_page_number }}">Previous</a>{% endif %}
  Page {{ products.number }} of {{ products.paginator.num_pages }}
  {% if products.has_next %}<a href="?page={{ products.next_page_number }}">Next</a>{% endif %}
</div>
</body>
</html>