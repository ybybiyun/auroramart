{% extends "adminpanel/base.html" %}
{% block title %}Dashboard • AuroraMart Admin{% endblock %}
{% block header_title %}Dashboard{% endblock %}

{% block content %}
<form method="get" style="margin-bottom:20px; display:flex; gap:14px; flex-wrap:wrap;">
  <label style="font-size:13px;">Category
    <select name="category">
      <option value="">All</option>
      {% for c in categories %}
        <option value="{{ c.category_id }}" {% if category_id == c.category_id|stringformat:"s" %}selected{% endif %}>{{ c.category_name }}</option>
      {% endfor %}
    </select>
  </label>
  <label style="font-size:13px;">Start
    <input type="date" name="start" value="{{ start_date }}">
  </label>
  <label style="font-size:13px;">End
    <input type="date" name="end" value="{{ end_date }}">
  </label>
  <button type="submit" style="padding:6px 14px; border:1px solid var(--border); background:var(--accent); color:#fff; border-radius:6px;">Apply</button>
</form>

<div class="grid">
  <div class="card">
    <h3>Total SKUs</h3>
    <div class="value">{{ total_skus }}</div>
  </div>
  <div class="card">
    <h3>Low Stock</h3>
    <div class="value" style="color:var(--danger);">{{ low_stock_count }}</div>
  </div>
  <div class="card">
    <h3>Units On Hand</h3>
    <div class="value">{{ total_units }}</div>
  </div>
  <div class="card">
    <h3>Inventory Value</h3>
    <div class="value">${{ inventory_value|floatformat:2 }}</div>
  </div>
  <div class="card">
    <h3>Revenue</h3>
    <div class="value">${{ sales_revenue|floatformat:2 }}</div>
    <div style="font-size:11px; color:var(--muted);">{{ start_date }} → {{ end_date }}</div>
  </div>
  <div class="card">
    <h3>Units Sold</h3>
    <div class="value">{{ units_sold }}</div>
  </div>
  <div class="card">
    <h3>Orders</h3>
    <div class="value">{{ orders_count }}</div>
  </div>
</div>

<h2 style="margin:30px 0 12px; font-size:18px;">Top Products</h2>
<table>
  <thead>
    <tr><th>SKU</th><th>Name</th><th>Units Sold</th></tr>
  </thead>
  <tbody>
    {% for tp in top_products %}
      <tr>
        <td>{{ tp.product__sku }}</td>
        <td>{{ tp.product__product_name }}</td>
        <td>{{ tp.total_qty }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="3">No sales in selected range.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}